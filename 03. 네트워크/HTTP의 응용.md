# HTTP 응용

## 쿠키 
1. 서버에서 생성되어 클라이언트에 `<Name, Value>` 형태로 저장되는 데이터  
2. 이름, 값 외에도 쿠키 만료 기간 등과 같은 다양한 속성을 가질 수 있음  
3. HTTP의 스테이트리스한 특성을 보완하기 위한 대표적 수단   
4. 클라이언트는 서버로부터 받은 쿠키를 주로 브라우저에 저장  
```  
🔥 크롬 브라우저   
- [개발자 도구] >  Application > Storage > Cookies 에서 확인 가능 
```  
5. 서버 -> 클라이언트 : `Set-Cookie` 헤더 활용   
6. 클라이언트 -> 서버 : `Cookie` 헤더 활용   


- **쿠키의 보안 속성**
1. **Secure** : HTTPS를 통해서만 쿠키 송수신 가능   
2. **HttpOnly** : 자바스크립트를 통한 쿠키의 접근을 제한하고 오직 HTTP 송수신을 통해서만 쿠키에 접근하도록 하는 방식  


## 웹 스토리지 
- 웹 스토리지   
    1. 웹 브라우저 내의 저장 공간 
    2. 일반적으로 쿠키보다 더 큰 데이터 저장 가능 
    3. 쿠키는 서버로 자동 전송, 웹 스토리지는 자동 전송 X 
    4. 웹 스토리지에는 크게 로컬 스토리지, 세션 스토리지가 있다. 
- 로컬 스토리지   
    1. 별도로 삭제하지 않는한 영구적으로 저장이 가능한 정보 
- 세션 스토리지    
    1. 세션이 유지되는 동안 (= 브라우저가 열려 있는 동안) 유지되는 정보 



## 캐시 
1. 캐시 메모리 마냥 HTTP에도 이와 유사한 개념인 HTTP 캐시가 존재 
2. 캐시는 응답받은 자원의 사본을 임시로 저장하여 불필요한 대역폭 낭비와 응답 지연을 방지하는 기술 
```
캐시는 클라이언트 (주로 웹 브라우저)에 저장되기도 하고,
클라이언트와 서버 사이에 위치한 중간 서버에 저장되기도 합니다. 

전자를 개인 전용 캐시
후자를 공용 캐시라고 합니다. 

```
3. 대부분의 캐시 데이터는 유효기간 설정이 되어 있음
```
🔥 유효기간 부여를 위해 다음 설정 활용
- 응답 메시지의 Expires 헤더 
- Cache Control 헤더의 Max-Age 값

클라이언트가 응답받은 자원을 임시 저장하여 이용하다가 유효기간이 만료되면 다시 서버에 자원을 요청해야 함 
```
4. 캐시 유효기간 만료되었을 때 반드시 서버로부터 다시 자원을 응답받을 필요는 없음. 만약 캐시 데이터가 여전히 최신 데이터이면 만료 시간만 연장하면 됨 
5. 이러한 특성으로 인해 클라이언트는 서버에게 원본 자원이 변경된 적이 있는지 질의 
```
'날짜' 기반으로 물을 수도 있고, '엔티티 태그'를 기반으로 물을 수도 있음

🔥 날짜 기반
- If-Modified-Since 헤더 활용 
- 특정 시점 이후로 원본 자원에 변경이 있었다면 그때만 변경된 자원을 메시지 본문으로 응답하도록 서버에게 요청하는 헤더 

서버는 다음과 같이 응답 가능
1. 자원 변경된 경우 상태 코드 200 (OK)과 함께 새로운 자원 반환 
2. 자원이 변경되지 않은 경우 메시지 본문 없이 304(Not Modified)를 통해 변경되지 않음을 알림, 또한 Last-Modified 헤더로 자원의 마지막 변경 시점도 알릴 수 있음 
3. 서버가 요청받은 자원이 삭제된 경우 404 (Not Found)를 통해 자원이 존재하지 않음을 알림 


🔥 엔티티 태그(Etag) 기반
- 엔티티 태그는 자원의 버전을 식별하기 위한 정보
- 자원이 변경될 떄 마다 자원의 버전을 식별하는 Etag가 변경됨 
- If-None-Match 헤더는 요청할 자원에 대한 Etag 값이 명시된다. 명시된 Etag 값과 일치하는 Etag가 없다면 그때만 변경된 자원으로 응답하도록 서버에게 요청하는 헤더 

서버는 다음과 같이 응답 가능
1. 자원이 변경된 경우 상태 코드 200과 함께 새로운 자원 반환
2. 자원이 변경되지 않으면 304
3. 삭제된 경우 404 
```



## 콘텐츠 협상
1. 이떄까지 HTTP 메시지를 통해 주고 받는 것을 자원이라고 표현함 
2. 좀 더 구체적으로 말하자면 `자원의 표현`을 주고 받음 
`표현`이란 `송수신 가능한 자원의 형태`를 의미 
3. 동일한 자원을 요청했더라도 한국어로 표현된 자원이 응답될 떄가 있고 영어로 표현된 자원이 응답될 떄가 있음 
4. **같은 자원에 대해 할 수 있는 여러 표현 중 클라이언트가 가장 적합한 자원의 표현을 제공하는 기술을 콘텐츠 협상이라고 함**
  
<br>

- **Accept** 
선호하는 미디어 타입을 나타내는 헤더
- **Accept-Language**
선호하는 언어를 나타내는 헤더
- **Accept-Encoding**
선호하는 인코딩 방식을 나타내는 헤더 

5. 클라이언트가 우선순위를 반영하여 여러 표현에 대해 선호도롤 알릴 수도 있음
6. 이러한 우선순위는 콘텐츠 협상 관련 헤더의 `q값`으로 표현됨
```
q는 Quality Value의 약자 
0~1 까지 표현
1에 가까울수록 우선순위가 높음 
``` 